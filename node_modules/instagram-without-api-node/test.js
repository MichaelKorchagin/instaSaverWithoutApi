const { iwa, iwaId, iwaIdUrl } = require('instagram-without-api-node');

const _cookie = 'ig_did=F98AFF14-3FC4-49E9-B8A5-0A84F089E133; ig_nrcb=1; mid=Y2_RzAALAAGKqBLWWdvNETB63HwN; datr=ydFvY9wyirxTf4etpiP3g_Z1; shbid="2875\\0541782251858\\0541709188329:01f70c1c2816e55bf890631781336b210fa94abc9d8eb746634b1183de2236ded0f59859"; shbts="1677652329\\0541782251858\\0541709188329:01f7c0a3508edda6fd4dd9ebd0f3707a38b3643539e30f81c65ae291ed571f9fa459caea"; dpr=1.5; ds_user_id=8726346801; sessionid=8726346801%3AIv748XxMsiqS9D%3A14%3AAYdToi2Z92gMjxTxGlFgE0AkTSsLnY3uI8n_j-jhXQ; csrftoken=x953ybhR04J2EHTnusJ2lOVYGkUTgc1k; rur="CLN\\0548726346801\\0541709209212:01f7ecc87a3231b703d624dd9c986f6cefa37ee2fea08dcd2f761be752a5bbeffff8e4d7"'      // <!-- required!! please get your cookie from your browser console (6)
const _userAgent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36'      // <!-- required!! please get your user-agent from your browser console (7)
const _xIgAppId = '936619743392459'                 // <!-- required!! please get your x-ig-app-id from your browser console (8)

async function fetch() {

    // get the latest 12 feeds from an account (example https://www.instagram.com/orsifrancesco/)

    const responseIwa = await iwa({

        headers: {
            'cookie': _cookie,
            'user-agent': _userAgent,
            'x-ig-app-id': _xIgAppId
        },

        base64images: false,                    // <!-- optional, but without it, you will be not able to store/show images
        maxImages: 12,                           // <!-- optional, 12 is the max number
        file: "instagram-cache.json",           // <!-- optional, instagram-cache.json is by default
        pretty: true,                           // <!-- optional, prettyfy json true/false
        time: 3600,                             // <!-- optional, reload contents after 3600 seconds by default

        id: "gopro"                     // <!-- id is required

    })

    console.log({ responseIwa });



    // get picture and info from instagram id url (example https://www.instagram.com/p/Cgczi6qMuh1/)

    const responseIwaIdUrl = await iwaIdUrl({

        headers: {
            'cookie': _cookie,
            'user-agent': _userAgent,
            'x-ig-app-id': _xIgAppId
        },

        base64images: false,                    // <!-- optional, but without it, you will be not able to store/show images
        file: "instagram-cache-byidurl.json",   // <!-- optional, instagram-cache.json is by default
        pretty: true,                           // <!-- optional, prettyfy json true/false
        time: 3600,                             // <!-- optional, reload contents after 3600 seconds by default

        id: "Cgczi6qMuh1"                       // <!-- id is required

    })

    console.log({ responseIwaIdUrl });



    // get picture and info from instagram id (2890411760684296309 is the id of https://www.instagram.com/p/Cgczi6qMuh1/)

    const responseIwaId = await iwaId({

        headers: {
            'cookie': _cookie,
            'user-agent': _userAgent,
            'x-ig-app-id': _xIgAppId
        },

        base64images: false,                    // <!-- optional, but without it, you will be not able to store/show images
        file: "instagram-cache-byid.json",      // <!-- optional, instagram-cache.json is by default
        pretty: true,                           // <!-- optional, prettyfy json true/false
        time: 3600,                             // <!-- optional, reload contents after 3600 seconds by default

        id: "2890411760684296309"               // <!-- id is required

    })

    console.log({ responseIwaId });

}
fetch()